{
  "name": "real-time-editor",
  "type": "registry:ui",
  "title": "Real-Time Editor",
  "description": "An optimized, animated text editor component with smooth selection animations, toolbar with animated cursor, text formatting (bold/italic/underline), color changes, and alignment controls.",
  "dependencies": [
    "framer-motion",
    "lucide-react",
    "react-icons"
  ],
  "registryDependencies": [],
  "files": [
    {
      "path": "components/ui/real-time-editor.tsx",
      "content": "\"use client\";\n\nimport React, { memo, useEffect, useState, useCallback, useRef, useMemo } from \"react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { cn } from \"@/lib/utils\";\nimport {\n  Bold,\n  Italic,\n  Underline,\n  AlignLeft,\n  AlignCenter,\n  AlignRight,\n  MessageSquare,\n  Link,\n  ExternalLink,\n} from \"lucide-react\";\nimport { BsCursorFill } from \"react-icons/bs\";\nimport { MdOutlineTextDecrease, MdOutlineTextIncrease } from \"react-icons/md\";\n\ntype AnimationPhase =\n  | \"idle\"\n  | \"selecting\"\n  | \"bold\"\n  | \"italic\"\n  | \"underline\"\n  | \"textColorRed\"\n  | \"textColorBlue\"\n  | \"textColorGreen\"\n  | \"hold1\"\n  | \"selectAll\"\n  | \"alignCenter\"\n  | \"alignRight\"\n  | \"alignLeft\"\n  | \"hold2\";\n\ntype TextAlignment = \"left\" | \"center\" | \"right\";\n\ninterface FormattingState {\n  isBold: boolean;\n  isItalic: boolean;\n  isUnderline: boolean;\n  textColorClass: string;\n}\n\nconst INITIAL_FORMATTING: FormattingState = {\n  isBold: false,\n  isItalic: false,\n  isUnderline: false,\n  textColorClass: \"\",\n};\n\nconst SPRING_CONFIG = {\n  type: \"spring\" as const,\n  stiffness: 350,\n  damping: 30,\n};\n\ninterface ToolbarButtonProps {\n  children: React.ReactNode;\n  isActive?: boolean;\n  showCursor?: boolean;\n  className?: string;\n}\n\nconst ToolbarButton = memo(\n  ({ children, isActive = false, showCursor = false, className }: ToolbarButtonProps) => (\n    <div className=\"relative flex flex-col items-center\">\n      {showCursor && (\n        <motion.div\n          layoutId=\"toolbar-bg\"\n          className=\"absolute inset-0 bg-blue-500/20 rounded-md border border-blue-500/30\"\n          transition={SPRING_CONFIG}\n        />\n      )}\n      <motion.button\n        className={cn(\n          \"relative z-10 p-1.5 rounded-md transition-colors duration-200\",\n          isActive\n            ? \"text-blue-800 dark:text-blue-400 bg-blue-500/15 hover:bg-blue-500/30\"\n            : \"text-black dark:text-neutral-400 hover:text-neutral-800 dark:hover:text-neutral-300 hover:bg-neutral-400/50 dark:hover:bg-neutral-700/50\",\n          className\n        )}\n      >\n        {children}\n      </motion.button>\n      {showCursor && (\n        <motion.div\n          layoutId=\"cursor-icon\"\n          className=\"absolute -bottom-5 drop-shadow-[0_0_4px_rgba(59,130,246,0.6)]\"\n          transition={SPRING_CONFIG}\n        >\n          <BsCursorFill className=\"w-3 h-3 -rotate-[60deg] text-black dark:text-white\" />\n        </motion.div>\n      )}\n    </div>\n  )\n);\n\nToolbarButton.displayName = \"ToolbarButton\";\n\ninterface ColorPickerProps {\n  color: string;\n  isActive?: boolean;\n}\n\nconst ColorPicker = memo(({ color, isActive = false }: ColorPickerProps) => (\n  <motion.div\n    className={cn(\n      \"w-5 h-5 rounded-full border-2 cursor-pointer transition-all duration-300\",\n      isActive ? \"border-blue-400 ring-2 ring-blue-500/50\" : \"border-neutral-600\",\n      !isActive && \"bg-black dark:bg-white\"\n    )}\n    style={isActive ? { backgroundColor: color } : undefined}\n    animate={isActive ? { scale: [1, 1.2, 1] } : { scale: 1 }}\n    transition={{ duration: 0.3 }}\n  />\n));\n\nColorPicker.displayName = \"ColorPicker\";\n\ninterface SelectionLineProps {\n  index: number;\n  totalLines: number;\n  isVisible: boolean;\n  selectionDuration: number;\n}\n\nconst SelectionLine = memo(({ index, totalLines, isVisible, selectionDuration }: SelectionLineProps) => {\n  const staggerDelay = (index / totalLines) * selectionDuration;\n  \n  return (\n    <motion.div\n      className=\"bg-blue-500/30 rounded-[2px] origin-left will-change-transform\"\n      initial={{ scaleX: 0 }}\n      animate={{ scaleX: isVisible ? 1 : 0 }}\n      transition={{\n        duration: selectionDuration / totalLines / 1000,\n        delay: isVisible ? staggerDelay / 1000 : 0,\n        ease: \"easeOut\",\n      }}\n      style={{ height: `${100 / totalLines}%` }}\n    />\n  );\n});\n\nSelectionLine.displayName = \"SelectionLine\";\n\ninterface SelectionOverlayProps {\n  lineCount: number;\n  isVisible: boolean;\n  selectionDuration: number;\n}\n\nconst SelectionOverlay = memo(({ lineCount, isVisible, selectionDuration }: SelectionOverlayProps) => {\n  const lines = useMemo(() => Array.from({ length: lineCount }, (_, i) => i), [lineCount]);\n  \n  return (\n    <AnimatePresence>\n      {isVisible && (\n        <div className=\"absolute inset-0 -m-2 p-2 flex flex-col pointer-events-none z-0\">\n          {lines.map((index) => (\n            <SelectionLine\n              key={index}\n              index={index}\n              totalLines={lineCount}\n              isVisible={isVisible}\n              selectionDuration={selectionDuration}\n            />\n          ))}\n        </div>\n      )}\n    </AnimatePresence>\n  );\n});\n\nSelectionOverlay.displayName = \"SelectionOverlay\";\n\ninterface RealTimeEditorProps {\n  className?: string;\n  selectionDelay?: number;\n  formatDelay?: number;\n  holdDelay?: number;\n  textContent?: string;\n  selectedText?: string;\n}\n\nexport const RealTimeEditor = memo(\n  ({\n    className,\n    selectionDelay = 800,\n    formatDelay = 600,\n    holdDelay = 1000,\n    textContent = \"The art of crafting beautiful interfaces lies in the Details Matter philosophy. Every pixel, every animation, and every interaction should feel intentional and purposeful. Great design isn't just about aestheticsâ€”it's about creating experiences that users genuinely enjoy. When we focus on the small things, the big picture naturally falls into place...\",\n    selectedText = \"Details Matter\",\n  }: RealTimeEditorProps) => {\n    const [phase, setPhase] = useState<AnimationPhase>(\"idle\");\n    const [selectionProgress, setSelectionProgress] = useState(0);\n    const [formatting, setFormatting] = useState<FormattingState>(INITIAL_FORMATTING);\n    const [isFullTextSelected, setIsFullTextSelected] = useState(false);\n    const [textAlignment, setTextAlignment] = useState<TextAlignment>(\"left\");\n    const [activeColor, setActiveColor] = useState(\"\");\n    const [lineCount, setLineCount] = useState(7);\n    \n    const textRef = useRef<HTMLDivElement>(null);\n    const timeoutsRef = useRef<NodeJS.Timeout[]>([]);\n    const animationFrameRef = useRef<number | null>(null);\n\n    const clearAllTimeouts = useCallback(() => {\n      timeoutsRef.current.forEach(clearTimeout);\n      timeoutsRef.current = [];\n      if (animationFrameRef.current) {\n        cancelAnimationFrame(animationFrameRef.current);\n        animationFrameRef.current = null;\n      }\n    }, []);\n\n    // Debounced line calculation\n    useEffect(() => {\n      let resizeTimeout: NodeJS.Timeout;\n      \n      const calculateLines = () => {\n        if (textRef.current) {\n          const lineHeight = parseFloat(getComputedStyle(textRef.current).lineHeight) || 20;\n          const height = textRef.current.offsetHeight;\n          const lines = Math.ceil(height / lineHeight);\n          setLineCount(Math.max(1, lines));\n        }\n      };\n\n      const debouncedCalculate = () => {\n        clearTimeout(resizeTimeout);\n        resizeTimeout = setTimeout(calculateLines, 100);\n      };\n\n      calculateLines();\n      window.addEventListener(\"resize\", debouncedCalculate);\n      \n      return () => {\n        window.removeEventListener(\"resize\", debouncedCalculate);\n        clearTimeout(resizeTimeout);\n      };\n    }, [textContent, textAlignment]);\n\n    const resetAnimation = useCallback(() => {\n      setPhase(\"idle\");\n      setSelectionProgress(0);\n      setFormatting(INITIAL_FORMATTING);\n      setIsFullTextSelected(false);\n      setTextAlignment(\"left\");\n      setActiveColor(\"\");\n    }, []);\n\n    // Smooth selection progress animation using requestAnimationFrame\n    const animateSelection = useCallback((\n      startTime: number,\n      duration: number,\n      onProgress: (progress: number) => void,\n      onComplete: () => void\n    ) => {\n      const animate = (currentTime: number) => {\n        const elapsed = currentTime - startTime;\n        const progress = Math.min(elapsed / duration, 1);\n        \n        onProgress(progress);\n        \n        if (progress < 1) {\n          animationFrameRef.current = requestAnimationFrame(animate);\n        } else {\n          onComplete();\n        }\n      };\n      \n      animationFrameRef.current = requestAnimationFrame(animate);\n    }, []);\n\n    useEffect(() => {\n      const addTimeout = (callback: () => void, delay: number) => {\n        const timeout = setTimeout(callback, delay);\n        timeoutsRef.current.push(timeout);\n        return timeout;\n      };\n\n      const runAnimation = () => {\n        clearAllTimeouts();\n        resetAnimation();\n\n        let currentTime = 500;\n\n        // Phase 1: Selection animation with smooth progress\n        addTimeout(() => {\n          setPhase(\"selecting\");\n          const startTime = performance.now();\n          animateSelection(\n            startTime,\n            selectionDelay,\n            (progress) => setSelectionProgress(progress),\n            () => {}\n          );\n        }, currentTime);\n\n        currentTime += selectionDelay + 200;\n\n        // Phase 2: Bold\n        addTimeout(() => {\n          setPhase(\"bold\");\n          setFormatting(prev => ({ ...prev, isBold: true }));\n        }, currentTime);\n        currentTime += formatDelay;\n\n        // Phase 3: Italic\n        addTimeout(() => {\n          setPhase(\"italic\");\n          setFormatting(prev => ({ ...prev, isItalic: true }));\n        }, currentTime);\n        currentTime += formatDelay;\n\n        // Phase 4: Underline\n        addTimeout(() => {\n          setPhase(\"underline\");\n          setFormatting(prev => ({ ...prev, isUnderline: true }));\n        }, currentTime);\n        currentTime += formatDelay;\n\n        // Phase 5: Text Color Red\n        addTimeout(() => {\n          setPhase(\"textColorRed\");\n          setFormatting(prev => ({ ...prev, textColorClass: \"text-rose-400\" }));\n          setActiveColor(\"#f43f5e\");\n        }, currentTime);\n        currentTime += formatDelay;\n\n        // Phase 6: Text Color Blue\n        addTimeout(() => {\n          setPhase(\"textColorBlue\");\n          setFormatting(prev => ({ ...prev, textColorClass: \"text-blue-400\" }));\n          setActiveColor(\"#3b82f6\");\n        }, currentTime);\n        currentTime += formatDelay;\n\n        // Phase 7: Text Color Green\n        addTimeout(() => {\n          setPhase(\"textColorGreen\");\n          setFormatting(prev => ({ ...prev, textColorClass: \"text-emerald-400\" }));\n          setActiveColor(\"#34d399\");\n        }, currentTime);\n        currentTime += formatDelay;\n\n        // Phase 8: Hold 1\n        addTimeout(() => setPhase(\"hold1\"), currentTime);\n        currentTime += holdDelay;\n\n        // Phase 9: Select All - Framer Motion handles the animation\n        addTimeout(() => {\n          setPhase(\"selectAll\");\n          setIsFullTextSelected(true);\n        }, currentTime);\n        currentTime += selectionDelay * 1.2 + 200;\n\n        // Phase 10: Align Center\n        addTimeout(() => {\n          setPhase(\"alignCenter\");\n          setTextAlignment(\"center\");\n        }, currentTime);\n        currentTime += formatDelay;\n\n        // Phase 11: Align Right\n        addTimeout(() => {\n          setPhase(\"alignRight\");\n          setTextAlignment(\"right\");\n        }, currentTime);\n        currentTime += formatDelay;\n\n        // Phase 12: Align Left\n        addTimeout(() => {\n          setPhase(\"alignLeft\");\n          setTextAlignment(\"left\");\n        }, currentTime);\n        currentTime += formatDelay;\n\n        // Phase 13: Hold 2\n        addTimeout(() => setPhase(\"hold2\"), currentTime);\n        currentTime += holdDelay;\n\n        // Restart animation\n        addTimeout(runAnimation, currentTime);\n      };\n\n      runAnimation();\n\n      return clearAllTimeouts;\n    }, [selectionDelay, formatDelay, holdDelay, resetAnimation, clearAllTimeouts, animateSelection]);\n\n    // Memoized derived values\n    const cursorTarget = useMemo((): string | null => {\n      switch (phase) {\n        case \"bold\": return \"bold\";\n        case \"italic\": return \"italic\";\n        case \"underline\": return \"underline\";\n        case \"textColorRed\":\n        case \"textColorBlue\":\n        case \"textColorGreen\": return \"color\";\n        case \"alignLeft\": return \"alignLeft\";\n        case \"alignCenter\": return \"alignCenter\";\n        case \"alignRight\": return \"alignRight\";\n        default: return null;\n      }\n    }, [phase]);\n\n    const isColorPickerActive = useMemo(() => \n      !isFullTextSelected && (phase === \"textColorRed\" || phase === \"textColorBlue\" || phase === \"textColorGreen\"),\n      [isFullTextSelected, phase]\n    );\n\n    const isAlignLeftActive = useMemo(() => \n      textAlignment === \"left\" && (phase === \"alignLeft\" || phase === \"hold2\" || (!isFullTextSelected && phase !== \"alignCenter\" && phase !== \"alignRight\")),\n      [textAlignment, phase, isFullTextSelected]\n    );\n\n    const isAlignCenterActive = useMemo(() => \n      phase === \"alignCenter\" || (textAlignment === \"center\" && phase !== \"alignLeft\" && phase !== \"alignRight\"),\n      [phase, textAlignment]\n    );\n\n    const isAlignRightActive = useMemo(() => phase === \"alignRight\", [phase]);\n\n    const isBoldActive = useMemo(() => \n      !isFullTextSelected && (phase === \"bold\" || formatting.isBold),\n      [isFullTextSelected, phase, formatting.isBold]\n    );\n\n    const isItalicActive = useMemo(() => \n      !isFullTextSelected && (phase === \"italic\" || (formatting.isItalic && phase !== \"bold\")),\n      [isFullTextSelected, phase, formatting.isItalic]\n    );\n\n    const isUnderlineActive = useMemo(() => \n      !isFullTextSelected && (phase === \"underline\" || (formatting.isUnderline && phase !== \"bold\" && phase !== \"italic\")),\n      [isFullTextSelected, phase, formatting.isUnderline]\n    );\n\n    // Memoized text content computation\n    const { beforeText, afterText, selectedIndex } = useMemo(() => {\n      const idx = textContent.indexOf(selectedText);\n      return {\n        selectedIndex: idx,\n        beforeText: idx !== -1 ? textContent.slice(0, idx) : \"\",\n        afterText: idx !== -1 ? textContent.slice(idx + selectedText.length) : \"\",\n      };\n    }, [textContent, selectedText]);\n\n    const renderTextWithSelection = useCallback(() => {\n      if (selectedIndex === -1) {\n        return <span>{textContent}</span>;\n      }\n\n      const isSelecting = phase !== \"idle\";\n      const charactersToShow = Math.floor(selectionProgress * selectedText.length);\n\n      const selectedTextStyles = cn(\n        \"relative z-10 transition-all duration-200\",\n        isSelecting && !isFullTextSelected && \"border-l-2 border-r-2 border-blue-500/60\",\n        formatting.isBold && \"font-bold\",\n        formatting.isItalic && \"italic\",\n        formatting.isUnderline && \"underline decoration-2 underline-offset-2\",\n        formatting.textColorClass\n      );\n\n      if (isFullTextSelected) {\n        return textContent;\n      }\n\n      return (\n        <>\n          <span>{beforeText}</span>\n          <span className=\"relative inline\">\n            {isSelecting && (\n              <motion.span\n                className=\"absolute inset-0 bg-blue-500/30 rounded-sm will-change-transform\"\n                initial={{ width: 0 }}\n                animate={{ width: `${selectionProgress * 100}%` }}\n                transition={{ duration: 0.016, ease: \"linear\" }}\n                style={{ display: \"inline-block\", height: \"100%\" }}\n              />\n            )}\n            <span className={selectedTextStyles}>\n              {phase === \"selecting\" && selectionProgress < 1\n                ? selectedText.slice(0, charactersToShow)\n                : selectedText}\n              {phase === \"selecting\" && selectionProgress < 1 && (\n                <span className=\"opacity-100\">\n                  {selectedText.slice(charactersToShow)}\n                </span>\n              )}\n            </span>\n          </span>\n          <span>{afterText}</span>\n        </>\n      );\n    }, [\n      selectedIndex, textContent, selectedText, phase, selectionProgress,\n      isFullTextSelected, formatting, beforeText, afterText\n    ]);\n\n    return (\n      <div\n        className={cn(\n          \"relative w-full max-w-2xl overflow-hidden mx-auto rounded-2xl\",\n          \"dark:bg-neutral-950 bg-white\",\n          \"border border-neutral-300/70 dark:border-neutral-700/30 shadow-2xl shadow-neutral-200/50 dark:shadow-neutral-900/50\",\n          className\n        )}\n      >\n        <div className=\"max-w-xl p-4 md:my-8 relative mx-auto\">\n          <div className=\"absolute top-0 left-1/2 transform -translate-x-1/2 w-full h-full bg-gradient-to-r from-blue-500/20 via-cyan-500/10 to-blue-500/20 blur-3xl pointer-events-none\" />\n\n          {/* Toolbar */}\n          <div className=\"relative z-10 p-[1px] rounded-xl bg-gradient-to-r from-blue-500/20 via-cyan-500/15 to-blue-700/20 shadow-neutral-100 dark:shadow-neutral-950 shadow-sm\">\n            <div className=\"relative flex-wrap justify-center flex items-center gap-1 px-4 py-3 rounded-xl bg-neutral-50 dark:bg-[#111111] backdrop-blur-sm\">\n              \n              {/* Format buttons */}\n              <div className=\"flex items-center gap-0.5\">\n                <ToolbarButton isActive={isBoldActive} showCursor={cursorTarget === \"bold\"}>\n                  <Bold className=\"w-4 h-4\" />\n                </ToolbarButton>\n                <ToolbarButton isActive={isItalicActive} showCursor={cursorTarget === \"italic\"}>\n                  <Italic className=\"w-4 h-4\" />\n                </ToolbarButton>\n                <ToolbarButton isActive={isUnderlineActive} showCursor={cursorTarget === \"underline\"}>\n                  <Underline className=\"w-4 h-4\" />\n                </ToolbarButton>\n              </div>\n\n              {/* Color picker */}\n              <div className=\"relative flex flex-col items-center mx-2\">\n                {cursorTarget === \"color\" && (\n                  <motion.div\n                    layoutId=\"toolbar-bg\"\n                    className=\"absolute inset-[-4px] bg-blue-500/20 rounded-full border border-blue-500/30\"\n                    transition={SPRING_CONFIG}\n                  />\n                )}\n                <div className=\"relative z-10\">\n                  <ColorPicker color={activeColor} isActive={isColorPickerActive} />\n                </div>\n                {cursorTarget === \"color\" && (\n                  <motion.div\n                    layoutId=\"cursor-icon\"\n                    className=\"absolute -bottom-5 drop-shadow-[0_0_4px_rgba(59,130,246,0.6)]\"\n                    transition={SPRING_CONFIG}\n                  >\n                    <BsCursorFill className=\"w-3 h-3 -rotate-[60deg] text-black dark:text-white\" />\n                  </motion.div>\n                )}\n              </div>\n\n              <div className=\"w-px h-5 bg-neutral-600 mx-1\" />\n\n              {/* Alignment buttons */}\n              <div className=\"flex items-center gap-0.5\">\n                <ToolbarButton isActive={isAlignLeftActive} showCursor={cursorTarget === \"alignLeft\"}>\n                  <AlignLeft className=\"w-4 h-4\" />\n                </ToolbarButton>\n                <ToolbarButton isActive={isAlignCenterActive} showCursor={cursorTarget === \"alignCenter\"}>\n                  <AlignCenter className=\"w-4 h-4\" />\n                </ToolbarButton>\n                <ToolbarButton isActive={isAlignRightActive} showCursor={cursorTarget === \"alignRight\"}>\n                  <AlignRight className=\"w-4 h-4\" />\n                </ToolbarButton>\n              </div>\n\n              <div className=\"w-px h-5 bg-neutral-600 mx-1\" />\n\n              {/* Font size buttons */}\n              <div className=\"flex items-center gap-0.5\">\n                <ToolbarButton>\n                  <MdOutlineTextIncrease className=\"w-4 h-4\" />\n                </ToolbarButton>\n                <ToolbarButton>\n                  <MdOutlineTextDecrease className=\"w-4 h-4\" />\n                </ToolbarButton>\n              </div>\n\n              <div className=\"w-px h-5 bg-neutral-600 mx-1\" />\n\n              {/* Comment button */}\n              <div className=\"flex items-center gap-1 px-2 py-1 rounded-md text-black dark:text-neutral-400 dark:hover:text-white hover:bg-neutral-400/50 dark:hover:bg-neutral-700/50 cursor-pointer\">\n                <MessageSquare className=\"w-4 h-4\" />\n                <span className=\"text-xs\">Comment</span>\n              </div>\n\n              <ToolbarButton>\n                <ExternalLink className=\"w-4 h-4\" />\n              </ToolbarButton>\n\n              <ToolbarButton>\n                <Link className=\"w-4 h-4\" />\n              </ToolbarButton>\n            </div>\n          </div>\n\n          {/* Content area */}\n          <div className=\"relative p-[1px] mt-3 rounded-xl bg-gradient-to-r from-blue-500/20 via-cyan-500/15 to-blue-700/20 shadow-neutral-100 dark:shadow-neutral-950 shadow-sm\">\n            <div className=\"relative overflow-hidden rounded-xl bg-neutral-50 dark:bg-[#111111] z-10 pb-12 p-6\">\n              <div className=\"relative\">\n                <SelectionOverlay\n                  lineCount={lineCount}\n                  isVisible={isFullTextSelected}\n                  selectionDuration={selectionDelay * 1.2}\n                />\n                <motion.div\n                  ref={textRef}\n                  className=\"text-black dark:text-neutral-200 text-sm leading-relaxed font-light relative z-10\"\n                  animate={{ textAlign: textAlignment }}\n                  transition={{ duration: 0.3, ease: \"easeInOut\" }}\n                >\n                  {renderTextWithSelection()}\n                </motion.div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n);\n\nRealTimeEditor.displayName = \"RealTimeEditor\";\n\nexport default RealTimeEditor;\n",
      "type": "registry:ui",
      "target": "components/ui/real-time-editor.tsx"
    }
  ]
}